
 Namespace(batch_size=256, clip=0.25, conv_name='hgt', data_percentage=1.0, dropout=0.2, edge_name='paper_field_L2', exract_attention=False, fake_edges_percentage=0.7, graph_dir='output/graphs/OAG_graph50000.pk', graph_params_dir='config/HGT_graph_params_OAG.json', include_fake_edges=True, main_node='paper', model_dir='output', multi_lable_task=True, n_batch=32, n_epoch=30, n_heads=8, n_hid=400, n_layers=4, n_pool=4, optimizer='adamw', predicted_node_name='field', repeat=2, sample_depth=6, sample_width=128, show_tensor_board=False)
 Counter({'paper_field_L2': 201175, 'rev_paper_field_L2': 201175, 'field_field': 139035, 'rev_field_field': 139035, 'paper_field_L1': 107099, 'rev_paper_field_L1': 107099, 'author_affiliation': 80467, 'rev_author_affiliation': 80467, 'paper_field_L3': 73602, 'rev_paper_field_L3': 73602, 'paper_field_L0': 50036, 'rev_paper_field_L0': 50036, 'paper_author_write_other': 43403, 'rev_paper_author_write_other': 43403, 'paper_author_write_first': 33370, 'rev_paper_author_write_first': 33370, 'paper_venue_Conference': 29296, 'rev_paper_venue_Conference': 29296, 'paper_author_write_last': 28867, 'rev_paper_author_write_last': 28867, 'paper_field_L4': 25110, 'rev_paper_field_L4': 25110, 'paper_venue_Journal': 19564, 'rev_paper_venue_Journal': 19564, 'paper_field_L5': 15092, 'rev_paper_field_L5': 15092, 'rev_paper_paper': 12975, 'paper_paper': 12845, 'paper_venue_Repository': 1134, 'rev_paper_venue_Repository': 1134, 'paper_venue_Patent': 5, 'rev_paper_venue_Patent': 5})
 GNN configuration: 
 in_dim = 1169, n_hid = 400,              num_types = 5, num_relations = 35,             n_heads = 8, n_layers = 4, dropout = 0.2
 Data Preparation: 18.2s
 UPDATE!!!
 Epoch: 1 (42.8s)  LR: 0.00060 Train Loss: 6.57  Valid Loss: 6.35  Valid NDCG: 0.2143
 Data Preparation: 1.0s
 Epoch: 2 (37.4s)  LR: 0.00070 Train Loss: 6.02  Valid Loss: 6.34  Valid NDCG: 0.2122
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 3 (37.7s)  LR: 0.00078 Train Loss: 5.75  Valid Loss: 6.10  Valid NDCG: 0.2501
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 4 (38.2s)  LR: 0.00086 Train Loss: 5.46  Valid Loss: 6.02  Valid NDCG: 0.2831
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 5 (37.4s)  LR: 0.00092 Train Loss: 5.14  Valid Loss: 5.80  Valid NDCG: 0.3021
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 6 (37.7s)  LR: 0.00097 Train Loss: 4.97  Valid Loss: 5.82  Valid NDCG: 0.3285
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 7 (37.7s)  LR: 0.00099 Train Loss: 4.77  Valid Loss: 5.70  Valid NDCG: 0.3386
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 8 (37.8s)  LR: 0.00100 Train Loss: 4.64  Valid Loss: 5.51  Valid NDCG: 0.3626
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 9 (37.7s)  LR: 0.00099 Train Loss: 4.45  Valid Loss: 5.29  Valid NDCG: 0.3930
 Data Preparation: 1.0s
 5481 new edges will be added between Fields and author
 5775 new edges will be added between Fields and author
 5724 new edges will be added between Fields and author
 5536 new edges will be added between Fields and author
 6090 new edges will be added between Fields and author
 5715 new edges will be added between Fields and author
 5757 new edges will be added between Fields and author
 5766 new edges will be added between Fields and author
 5459 new edges will be added between Fields and author
 5502 new edges will be added between Fields and author
 5590 new edges will be added between Fields and author
 5481 new edges will be added between Fields and author
 5772 new edges will be added between Fields and author
 6059 new edges will be added between Fields and author
 5214 new edges will be added between Fields and author
 5534 new edges will be added between Fields and author
 5715 new edges will be added between Fields and author
 5732 new edges will be added between Fields and author
 5640 new edges will be added between Fields and author
 5800 new edges will be added between Fields and author
 5268 new edges will be added between Fields and author
 5885 new edges will be added between Fields and author
 5322 new edges will be added between Fields and author
 5445 new edges will be added between Fields and author
 5128 new edges will be added between Fields and author
 5478 new edges will be added between Fields and author
 5289 new edges will be added between Fields and author
 5692 new edges will be added between Fields and author
 5819 new edges will be added between Fields and author
 5685 new edges will be added between Fields and author
 5742 new edges will be added between Fields and author
 5383 new edges will be added between Fields and author
 Epoch: 10 (1615.9s)  LR: 0.00095 Train Loss: 4.33  Valid Loss: 5.72  Valid NDCG: 0.3419
 Data Preparation: 1.0s
 Epoch: 11 (37.8s)  LR: 0.00090 Train Loss: 4.21  Valid Loss: 5.31  Valid NDCG: 0.3917
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 12 (42.5s)  LR: 0.00083 Train Loss: 4.05  Valid Loss: 5.06  Valid NDCG: 0.4150
 Data Preparation: 1.0s
 Epoch: 13 (42.7s)  LR: 0.00075 Train Loss: 3.94  Valid Loss: 5.10  Valid NDCG: 0.4122
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 14 (42.7s)  LR: 0.00066 Train Loss: 3.81  Valid Loss: 5.27  Valid NDCG: 0.4222
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 15 (43.5s)  LR: 0.00056 Train Loss: 3.73  Valid Loss: 5.08  Valid NDCG: 0.4307
 Data Preparation: 1.1s
 Epoch: 16 (42.9s)  LR: 0.00046 Train Loss: 3.59  Valid Loss: 5.41  Valid NDCG: 0.4078
 Data Preparation: 1.0s
 Epoch: 17 (42.9s)  LR: 0.00036 Train Loss: 3.51  Valid Loss: 5.54  Valid NDCG: 0.3842
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 18 (42.7s)  LR: 0.00027 Train Loss: 3.47  Valid Loss: 5.14  Valid NDCG: 0.4336
 Data Preparation: 1.1s
 Epoch: 19 (42.9s)  LR: 0.00019 Train Loss: 3.40  Valid Loss: 5.06  Valid NDCG: 0.4189
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 20 (43.2s)  LR: 0.00012 Train Loss: 3.34  Valid Loss: 4.94  Valid NDCG: 0.4429
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 21 (42.6s)  LR: 0.00006 Train Loss: 3.34  Valid Loss: 4.67  Valid NDCG: 0.4865
 Data Preparation: 1.0s
 Epoch: 22 (42.9s)  LR: 0.00002 Train Loss: 3.36  Valid Loss: 5.09  Valid NDCG: 0.4431
 Data Preparation: 1.0s
 Epoch: 23 (42.5s)  LR: 0.00000 Train Loss: 3.37  Valid Loss: 5.05  Valid NDCG: 0.4447
 Data Preparation: 1.0s
 Epoch: 24 (42.7s)  LR: 0.00000 Train Loss: 3.37  Valid Loss: 5.16  Valid NDCG: 0.4570
 Data Preparation: 1.0s
 Epoch: 25 (42.7s)  LR: 0.00003 Train Loss: 3.35  Valid Loss: 5.07  Valid NDCG: 0.4348
 Data Preparation: 1.0s
 Epoch: 26 (43.3s)  LR: 0.00007 Train Loss: 3.31  Valid Loss: 4.83  Valid NDCG: 0.4650
 Data Preparation: 1.0s
 Epoch: 27 (42.6s)  LR: 0.00012 Train Loss: 3.28  Valid Loss: 4.96  Valid NDCG: 0.4558
 Data Preparation: 1.0s
 Epoch: 28 (42.5s)  LR: 0.00020 Train Loss: 3.24  Valid Loss: 5.19  Valid NDCG: 0.4249
 Data Preparation: 0.9s
 Epoch: 29 (42.5s)  LR: 0.00028 Train Loss: 3.22  Valid Loss: 5.01  Valid NDCG: 0.4617
 Data Preparation: 0.9s
 Epoch: 30 (42.6s)  LR: 0.00038 Train Loss: 3.14  Valid Loss: 5.10  Valid NDCG: 0.4484
 {'paper_author_write_first': 33370, 'paper_field_L1': 107099, 'paper_field_L2': 201175, 'paper_field_L0': 50036, 'paper_field_L3': 73602, 'paper_venue_Journal': 19564, 'rev_paper_paper': 12975, 'paper_field_L4': 25110, 'paper_author_write_last': 28867, 'paper_field_L5': 15092, 'paper_venue_Conference': 29296, 'paper_author_write_other': 43403, 'paper_paper': 12845, 'paper_venue_Repository': 1134, 'paper_venue_Patent': 5, 'rev_paper_author_write_other': 43403, 'author_affiliation': 80467, 'rev_paper_author_write_last': 28867, 'rev_paper_author_write_first': 33370, 'rev_fake_edge': 90014, 'rev_paper_venue_Conference': 29296, 'rev_paper_venue_Journal': 19564, 'rev_paper_venue_Patent': 5, 'rev_paper_venue_Repository': 1134, 'field_field': 139035, 'rev_paper_field_L3': 73602, 'rev_field_field': 139035, 'rev_paper_field_L5': 15092, 'rev_paper_field_L2': 201175, 'rev_paper_field_L4': 25110, 'fake_edge': 90014, 'rev_paper_field_L1': 107099, 'rev_paper_field_L0': 50036, 'rev_author_affiliation': 80467}
 Last Test NDCG: 0.4398
 Last Test MRR:  0.5823
 Best Test NDCG: 0.4335
 Best Test MRR:  0.5740
 Done after 2942.7s