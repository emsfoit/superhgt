
 Namespace(batch_size=256, clip=0.25, conv_name='hgt', data_percentage=1.0, dropout=0.2, edge_name='paper_field_L2', exract_attention=False, graph_dir='output/graphs/OAG_graph20000.pk', graph_params_dir='config/HGT_graph_params_OAG.json', main_node='paper', model_dir='output', multi_lable_task=True, n_batch=32, n_epoch=30, n_heads=8, n_hid=400, n_layers=4, n_pool=4, optimizer='adamw', predicted_node_name='field', repeat=2, sample_depth=6, sample_width=128, show_tensor_board=False)
 Counter({'field_field': 88057, 'rev_field_field': 88057, 'paper_field_L2': 77166, 'rev_paper_field_L2': 77166, 'paper_field_L1': 39345, 'rev_paper_field_L1': 39345, 'author_affiliation': 38299, 'rev_author_affiliation': 38299, 'paper_field_L3': 27948, 'rev_paper_field_L3': 27948, 'paper_author_write_other': 20542, 'rev_paper_author_write_other': 20542, 'paper_field_L0': 20017, 'rev_paper_field_L0': 20017, 'paper_author_write_first': 14243, 'rev_paper_author_write_first': 14243, 'paper_author_write_last': 12248, 'rev_paper_author_write_last': 12248, 'paper_venue_Conference': 10308, 'rev_paper_venue_Conference': 10308, 'paper_field_L4': 9800, 'rev_paper_field_L4': 9800, 'paper_venue_Journal': 8558, 'rev_paper_venue_Journal': 8558, 'paper_field_L5': 5882, 'rev_paper_field_L5': 5882, 'rev_paper_paper': 5118, 'paper_paper': 5064, 'paper_venue_Repository': 1132, 'rev_paper_venue_Repository': 1132, 'paper_venue_Patent': 2, 'rev_paper_venue_Patent': 2})
 Data Preparation: 12.9s
 UPDATE!!!
 Epoch: 1 (39.0s)  LR: 0.00060 Train Loss: 6.49  Valid Loss: 6.62  Valid NDCG: 0.1999
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 2 (33.3s)  LR: 0.00070 Train Loss: 5.97  Valid Loss: 6.61  Valid NDCG: 0.2026
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 3 (33.8s)  LR: 0.00078 Train Loss: 5.68  Valid Loss: 6.35  Valid NDCG: 0.2458
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 4 (33.8s)  LR: 0.00086 Train Loss: 5.34  Valid Loss: 6.37  Valid NDCG: 0.2617
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 5 (33.7s)  LR: 0.00092 Train Loss: 5.01  Valid Loss: 6.08  Valid NDCG: 0.3043
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 6 (33.6s)  LR: 0.00097 Train Loss: 4.73  Valid Loss: 6.11  Valid NDCG: 0.3202
 Data Preparation: 0.9s
 Epoch: 7 (33.9s)  LR: 0.00099 Train Loss: 4.53  Valid Loss: 6.48  Valid NDCG: 0.3087
 Data Preparation: 0.8s
 Epoch: 8 (33.6s)  LR: 0.00100 Train Loss: 4.40  Valid Loss: 6.42  Valid NDCG: 0.3186
 Data Preparation: 0.9s
 Epoch: 9 (34.4s)  LR: 0.00099 Train Loss: 4.19  Valid Loss: 6.38  Valid NDCG: 0.3063
 Data Preparation: 0.9s
 Take 1 * Edges with high attentions
 8178 new edges will be added between Fields and author
 7145 new edges will be added between Fields and author
 7701 new edges will be added between Fields and author
 7650 new edges will be added between Fields and author
 7936 new edges will be added between Fields and author
 7950 new edges will be added between Fields and author
 8321 new edges will be added between Fields and author
 8161 new edges will be added between Fields and author
 7554 new edges will be added between Fields and author
 7229 new edges will be added between Fields and author
 7948 new edges will be added between Fields and author
 8383 new edges will be added between Fields and author
 7507 new edges will be added between Fields and author
 7574 new edges will be added between Fields and author
 7860 new edges will be added between Fields and author
 8033 new edges will be added between Fields and author
 6935 new edges will be added between Fields and author
 7748 new edges will be added between Fields and author
 7852 new edges will be added between Fields and author
 7498 new edges will be added between Fields and author
 7892 new edges will be added between Fields and author
 7528 new edges will be added between Fields and author
 7572 new edges will be added between Fields and author
 7433 new edges will be added between Fields and author
 8612 new edges will be added between Fields and author
 7460 new edges will be added between Fields and author
 8193 new edges will be added between Fields and author
 7601 new edges will be added between Fields and author
 7953 new edges will be added between Fields and author
 7954 new edges will be added between Fields and author
 7807 new edges will be added between Fields and author
 7562 new edges will be added between Fields and author
 UPDATE!!!
 Epoch: 10 (1669.2s)  LR: 0.00095 Train Loss: 4.06  Valid Loss: 6.33  Valid NDCG: 0.3403
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 11 (31.2s)  LR: 0.00090 Train Loss: 3.89  Valid Loss: 6.22  Valid NDCG: 0.3516
 Data Preparation: 0.9s
 Epoch: 12 (36.0s)  LR: 0.00083 Train Loss: 3.87  Valid Loss: 6.46  Valid NDCG: 0.3230
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 13 (36.1s)  LR: 0.00075 Train Loss: 4.03  Valid Loss: 5.96  Valid NDCG: 0.3595
 Data Preparation: 0.9s
 Epoch: 14 (36.1s)  LR: 0.00066 Train Loss: 3.70  Valid Loss: 6.31  Valid NDCG: 0.3574
 Data Preparation: 0.8s
 UPDATE!!!
 Epoch: 15 (36.3s)  LR: 0.00056 Train Loss: 3.52  Valid Loss: 6.14  Valid NDCG: 0.3647
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 16 (36.4s)  LR: 0.00046 Train Loss: 3.59  Valid Loss: 6.51  Valid NDCG: 0.3760
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 17 (36.4s)  LR: 0.00036 Train Loss: 3.44  Valid Loss: 6.01  Valid NDCG: 0.3859
 Data Preparation: 0.8s
 UPDATE!!!
 Epoch: 18 (36.6s)  LR: 0.00027 Train Loss: 3.28  Valid Loss: 6.36  Valid NDCG: 0.3895
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 19 (36.1s)  LR: 0.00019 Train Loss: 3.25  Valid Loss: 6.06  Valid NDCG: 0.4244
 Data Preparation: 0.8s
 Epoch: 20 (36.4s)  LR: 0.00012 Train Loss: 3.15  Valid Loss: 6.31  Valid NDCG: 0.3878
 Data Preparation: 0.9s
 Epoch: 21 (39.0s)  LR: 0.00006 Train Loss: 3.11  Valid Loss: 6.14  Valid NDCG: 0.3894
 Data Preparation: 0.9s
 Epoch: 22 (40.2s)  LR: 0.00002 Train Loss: 3.12  Valid Loss: 6.16  Valid NDCG: 0.4093
 Data Preparation: 1.0s
 Epoch: 23 (39.7s)  LR: 0.00000 Train Loss: 3.10  Valid Loss: 6.41  Valid NDCG: 0.3921
 Data Preparation: 0.9s
 Epoch: 24 (39.6s)  LR: 0.00000 Train Loss: 3.13  Valid Loss: 6.09  Valid NDCG: 0.4085
 Data Preparation: 1.0s
 Epoch: 25 (38.7s)  LR: 0.00003 Train Loss: 3.11  Valid Loss: 6.12  Valid NDCG: 0.4204
 Data Preparation: 1.0s
 Epoch: 26 (38.1s)  LR: 0.00007 Train Loss: 3.07  Valid Loss: 6.06  Valid NDCG: 0.4147
 Data Preparation: 0.9s
 Epoch: 27 (38.5s)  LR: 0.00012 Train Loss: 3.03  Valid Loss: 5.89  Valid NDCG: 0.4148
 Data Preparation: 0.9s
 Epoch: 28 (38.7s)  LR: 0.00020 Train Loss: 3.01  Valid Loss: 6.27  Valid NDCG: 0.3870
 Data Preparation: 0.9s
 Epoch: 29 (38.6s)  LR: 0.00028 Train Loss: 2.96  Valid Loss: 6.31  Valid NDCG: 0.4001
 Data Preparation: 0.9s
 Epoch: 30 (39.3s)  LR: 0.00038 Train Loss: 3.00  Valid Loss: 6.66  Valid NDCG: 0.3716
 {'paper_author_write_first': 14243, 'paper_field_L1': 39345, 'paper_field_L2': 77166, 'paper_field_L0': 20017, 'paper_field_L3': 27948, 'paper_venue_Journal': 8558, 'paper_field_L4': 9800, 'rev_paper_paper': 5118, 'paper_author_write_last': 12248, 'paper_field_L5': 5882, 'paper_venue_Conference': 10308, 'paper_author_write_other': 20542, 'paper_paper': 5064, 'paper_venue_Repository': 1132, 'paper_venue_Patent': 2, 'rev_paper_author_write_first': 14243, 'author_affiliation': 38299, 'rev_fake_edge': 97485, 'rev_paper_author_write_last': 12248, 'rev_paper_author_write_other': 20542, 'rev_paper_venue_Conference': 10308, 'rev_paper_venue_Journal': 8558, 'rev_paper_venue_Patent': 2, 'rev_paper_venue_Repository': 1132, 'field_field': 88057, 'rev_field_field': 88057, 'rev_paper_field_L3': 27948, 'rev_paper_field_L5': 5882, 'fake_edge': 97485, 'rev_paper_field_L4': 9800, 'rev_paper_field_L2': 77166, 'rev_paper_field_L1': 39345, 'rev_paper_field_L0': 20017, 'rev_author_affiliation': 38299}
 Last Test NDCG: 0.3664
 Last Test MRR:  0.4583
 Best Test NDCG: 0.3664
 Best Test MRR:  0.4650
 Done after 2887.1s