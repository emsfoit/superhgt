
 Namespace(batch_size=256, clip=0.25, conv_name='hgt', data_percentage=1.0, dropout=0.2, edge_name='paper_field_L2', exract_attention=False, fake_edges_percentage=0.5, graph_dir='output/graphs/OAG_graph50000.pk', graph_params_dir='config/HGT_graph_params_OAG.json', include_fake_edges=False, main_node='paper', model_dir='output', multi_lable_task=True, n_batch=32, n_epoch=30, n_heads=8, n_hid=400, n_layers=4, n_pool=4, optimizer='adamw', predicted_node_name='field', repeat=2, sample_depth=6, sample_width=128, show_tensor_board=False)
 Counter({'paper_field_L2': 201175, 'rev_paper_field_L2': 201175, 'field_field': 139035, 'rev_field_field': 139035, 'paper_field_L1': 107099, 'rev_paper_field_L1': 107099, 'author_affiliation': 80467, 'rev_author_affiliation': 80467, 'paper_field_L3': 73602, 'rev_paper_field_L3': 73602, 'paper_field_L0': 50036, 'rev_paper_field_L0': 50036, 'paper_author_write_other': 43403, 'rev_paper_author_write_other': 43403, 'paper_author_write_first': 33370, 'rev_paper_author_write_first': 33370, 'paper_venue_Conference': 29296, 'rev_paper_venue_Conference': 29296, 'paper_author_write_last': 28867, 'rev_paper_author_write_last': 28867, 'paper_field_L4': 25110, 'rev_paper_field_L4': 25110, 'paper_venue_Journal': 19564, 'rev_paper_venue_Journal': 19564, 'paper_field_L5': 15092, 'rev_paper_field_L5': 15092, 'rev_paper_paper': 12975, 'paper_paper': 12845, 'paper_venue_Repository': 1134, 'rev_paper_venue_Repository': 1134, 'paper_venue_Patent': 5, 'rev_paper_venue_Patent': 5})
 GNN configuration: 
 in_dim = 1169, n_hid = 400,              num_types = 5, num_relations = 33,             n_heads = 8, n_layers = 4, dropout = 0.2
 Data Preparation: 18.6s
 UPDATE!!!
 Epoch: 1 (42.6s)  LR: 0.00060 Train Loss: 6.62  Valid Loss: 6.35  Valid NDCG: 0.2129
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 2 (37.5s)  LR: 0.00070 Train Loss: 5.99  Valid Loss: 6.30  Valid NDCG: 0.2183
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 3 (37.7s)  LR: 0.00078 Train Loss: 5.69  Valid Loss: 6.15  Valid NDCG: 0.2424
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 4 (37.9s)  LR: 0.00086 Train Loss: 5.40  Valid Loss: 6.10  Valid NDCG: 0.2743
 Data Preparation: 1.1s
 UPDATE!!!
 Epoch: 5 (37.1s)  LR: 0.00092 Train Loss: 5.11  Valid Loss: 5.85  Valid NDCG: 0.3023
 Data Preparation: 0.9s
 Epoch: 6 (37.5s)  LR: 0.00097 Train Loss: 4.87  Valid Loss: 6.25  Valid NDCG: 0.2924
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 7 (37.8s)  LR: 0.00099 Train Loss: 4.67  Valid Loss: 5.90  Valid NDCG: 0.3354
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 8 (37.5s)  LR: 0.00100 Train Loss: 4.44  Valid Loss: 5.80  Valid NDCG: 0.3565
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 9 (37.5s)  LR: 0.00099 Train Loss: 4.36  Valid Loss: 5.56  Valid NDCG: 0.3616
 Data Preparation: 1.0s
 Epoch: 10 (37.6s)  LR: 0.00095 Train Loss: 4.34  Valid Loss: 5.77  Valid NDCG: 0.3265
 Data Preparation: 0.9s
 Epoch: 11 (37.8s)  LR: 0.00090 Train Loss: 4.12  Valid Loss: 5.79  Valid NDCG: 0.3524
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 12 (37.9s)  LR: 0.00083 Train Loss: 3.99  Valid Loss: 5.40  Valid NDCG: 0.3855
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 13 (37.7s)  LR: 0.00075 Train Loss: 3.78  Valid Loss: 5.16  Valid NDCG: 0.4311
 Data Preparation: 1.0s
 Epoch: 14 (37.5s)  LR: 0.00066 Train Loss: 3.81  Valid Loss: 5.21  Valid NDCG: 0.4239
 Data Preparation: 0.9s
 Epoch: 15 (38.2s)  LR: 0.00056 Train Loss: 3.55  Valid Loss: 5.47  Valid NDCG: 0.4095
 Data Preparation: 1.0s
 Epoch: 16 (37.7s)  LR: 0.00046 Train Loss: 3.55  Valid Loss: 5.30  Valid NDCG: 0.4195
 Data Preparation: 0.9s
 Epoch: 17 (38.1s)  LR: 0.00036 Train Loss: 3.47  Valid Loss: 5.59  Valid NDCG: 0.4008
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 18 (37.4s)  LR: 0.00027 Train Loss: 3.42  Valid Loss: 5.24  Valid NDCG: 0.4390
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 19 (37.9s)  LR: 0.00019 Train Loss: 3.34  Valid Loss: 5.05  Valid NDCG: 0.4518
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 20 (37.9s)  LR: 0.00012 Train Loss: 3.32  Valid Loss: 4.93  Valid NDCG: 0.4729
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 21 (37.6s)  LR: 0.00006 Train Loss: 3.31  Valid Loss: 4.62  Valid NDCG: 0.5032
 Data Preparation: 0.9s
 Epoch: 22 (37.3s)  LR: 0.00002 Train Loss: 3.34  Valid Loss: 5.08  Valid NDCG: 0.4496
 Data Preparation: 1.0s
 Epoch: 23 (37.4s)  LR: 0.00000 Train Loss: 3.35  Valid Loss: 5.14  Valid NDCG: 0.4370
 Data Preparation: 1.0s
 Epoch: 24 (37.4s)  LR: 0.00000 Train Loss: 3.37  Valid Loss: 5.09  Valid NDCG: 0.4783
 Data Preparation: 0.9s
 Epoch: 25 (37.6s)  LR: 0.00003 Train Loss: 3.33  Valid Loss: 5.07  Valid NDCG: 0.4589
 Data Preparation: 0.9s
 Epoch: 26 (37.4s)  LR: 0.00007 Train Loss: 3.28  Valid Loss: 4.93  Valid NDCG: 0.4716
 Data Preparation: 0.9s
 Epoch: 27 (37.4s)  LR: 0.00012 Train Loss: 3.27  Valid Loss: 5.00  Valid NDCG: 0.4750
 Data Preparation: 1.0s
 Epoch: 28 (38.5s)  LR: 0.00020 Train Loss: 3.22  Valid Loss: 5.23  Valid NDCG: 0.4443
 Data Preparation: 0.9s
 Epoch: 29 (36.9s)  LR: 0.00028 Train Loss: 3.16  Valid Loss: 4.96  Valid NDCG: 0.4770
 Data Preparation: 1.0s
 Epoch: 30 (37.0s)  LR: 0.00038 Train Loss: 3.13  Valid Loss: 5.02  Valid NDCG: 0.4726
 {'paper_author_write_first': 33370, 'paper_field_L1': 107099, 'paper_field_L2': 201175, 'paper_field_L0': 50036, 'paper_field_L3': 73602, 'paper_venue_Journal': 19564, 'rev_paper_paper': 12975, 'paper_field_L4': 25110, 'paper_author_write_last': 28867, 'paper_field_L5': 15092, 'paper_venue_Conference': 29296, 'paper_author_write_other': 43403, 'paper_paper': 12845, 'paper_venue_Repository': 1134, 'paper_venue_Patent': 5, 'rev_paper_author_write_other': 43403, 'author_affiliation': 80467, 'rev_paper_author_write_last': 28867, 'rev_paper_author_write_first': 33370, 'rev_paper_venue_Conference': 29296, 'rev_paper_venue_Journal': 19564, 'rev_paper_venue_Patent': 5, 'rev_paper_venue_Repository': 1134, 'field_field': 139035, 'rev_paper_field_L3': 73602, 'rev_field_field': 139035, 'rev_paper_field_L5': 15092, 'rev_paper_field_L2': 201175, 'rev_paper_field_L4': 25110, 'rev_paper_field_L1': 107099, 'rev_paper_field_L0': 50036, 'rev_author_affiliation': 80467}
 Last Test NDCG: 0.4636
 Last Test MRR:  0.6253
 Best Test NDCG: 0.4390
 Best Test MRR:  0.5834
 Done after 1266.1s