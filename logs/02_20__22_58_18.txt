
 Namespace(batch_size=256, clip=0.25, conv_name='hgt', data_percentage=1.0, dropout=0.2, edge_name='paper_field_L2', exract_attention=False, graph_dir='output/graphs/OAG_graph50000.pk', graph_params_dir='config/HGT_graph_params_OAG.json', include_fake_edges=False, main_node='paper', model_dir='output', multi_lable_task=True, n_batch=32, n_epoch=30, n_heads=8, n_hid=400, n_layers=4, n_pool=4, optimizer='adamw', predicted_node_name='field', remove_edges=True, repeat=2, restructure_at_epoch=10, sample_depth=6, sample_width=128, show_tensor_board=False)
 Counter({'paper_field_L2': 201175, 'rev_paper_field_L2': 201175, 'field_field': 139035, 'rev_field_field': 139035, 'paper_field_L1': 107099, 'rev_paper_field_L1': 107099, 'author_affiliation': 80467, 'rev_author_affiliation': 80467, 'paper_field_L3': 73602, 'rev_paper_field_L3': 73602, 'paper_field_L0': 50036, 'rev_paper_field_L0': 50036, 'paper_author_write_other': 43403, 'rev_paper_author_write_other': 43403, 'paper_author_write_first': 33370, 'rev_paper_author_write_first': 33370, 'paper_venue_Conference': 29296, 'rev_paper_venue_Conference': 29296, 'paper_author_write_last': 28867, 'rev_paper_author_write_last': 28867, 'paper_field_L4': 25110, 'rev_paper_field_L4': 25110, 'paper_venue_Journal': 19564, 'rev_paper_venue_Journal': 19564, 'paper_field_L5': 15092, 'rev_paper_field_L5': 15092, 'rev_paper_paper': 12975, 'paper_paper': 12845, 'paper_venue_Repository': 1134, 'rev_paper_venue_Repository': 1134, 'paper_venue_Patent': 5, 'rev_paper_venue_Patent': 5})
 GNN configuration: 
 in_dim = 1169, n_hid = 400,              num_types = 5, num_relations = 33,             n_heads = 8, n_layers = 4, dropout = 0.2
 Data Preparation: 18.4s
 UPDATE!!!
 Epoch: 1 (45.2s)  LR: 0.00060 Train Loss: 6.57  Valid Loss: 6.32  Valid NDCG: 0.2129
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 2 (38.8s)  LR: 0.00070 Train Loss: 5.96  Valid Loss: 6.31  Valid NDCG: 0.2310
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 3 (40.3s)  LR: 0.00078 Train Loss: 5.71  Valid Loss: 6.11  Valid NDCG: 0.2528
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 4 (38.5s)  LR: 0.00086 Train Loss: 5.42  Valid Loss: 6.12  Valid NDCG: 0.2854
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 5 (38.5s)  LR: 0.00092 Train Loss: 5.19  Valid Loss: 5.70  Valid NDCG: 0.3031
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 6 (39.0s)  LR: 0.00097 Train Loss: 5.01  Valid Loss: 5.79  Valid NDCG: 0.3179
 Data Preparation: 1.1s
 UPDATE!!!
 Epoch: 7 (39.1s)  LR: 0.00099 Train Loss: 4.82  Valid Loss: 5.78  Valid NDCG: 0.3438
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 8 (38.8s)  LR: 0.00100 Train Loss: 4.66  Valid Loss: 5.57  Valid NDCG: 0.3525
 Data Preparation: 1.1s
 UPDATE!!!
 Epoch: 9 (39.3s)  LR: 0.00099 Train Loss: 4.53  Valid Loss: 5.32  Valid NDCG: 0.3880
 Data Preparation: 1.0s
 Epoch: 10 (85.4s)  LR: 0.00095 Train Loss: 4.48  Valid Loss: 5.45  Valid NDCG: 0.3673
 22799/113995 will be removed
 5200/25998 will be removed
 27999 total edges will be removed.
 Data Preparation: 30.0s
 UPDATE!!!
 Epoch: 11 (39.2s)  LR: 0.00090 Train Loss: 4.33  Valid Loss: 5.25  Valid NDCG: 0.4010
 Data Preparation: 1.1s
 UPDATE!!!
 Epoch: 12 (38.3s)  LR: 0.00083 Train Loss: 4.23  Valid Loss: 4.94  Valid NDCG: 0.4412
 Data Preparation: 1.1s
 UPDATE!!!
 Epoch: 13 (37.5s)  LR: 0.00075 Train Loss: 3.99  Valid Loss: 4.95  Valid NDCG: 0.4450
 Data Preparation: 1.1s
 UPDATE!!!
 Epoch: 14 (37.3s)  LR: 0.00066 Train Loss: 3.94  Valid Loss: 5.06  Valid NDCG: 0.4665
 Data Preparation: 1.1s
 Epoch: 15 (38.9s)  LR: 0.00056 Train Loss: 3.82  Valid Loss: 5.01  Valid NDCG: 0.4445
 Data Preparation: 1.0s
 Epoch: 16 (39.1s)  LR: 0.00046 Train Loss: 3.74  Valid Loss: 5.07  Valid NDCG: 0.4553
 Data Preparation: 1.1s
 Epoch: 17 (37.5s)  LR: 0.00036 Train Loss: 3.68  Valid Loss: 5.31  Valid NDCG: 0.4142
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 18 (37.9s)  LR: 0.00027 Train Loss: 3.61  Valid Loss: 4.93  Valid NDCG: 0.4710
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 19 (36.6s)  LR: 0.00019 Train Loss: 3.54  Valid Loss: 4.67  Valid NDCG: 0.4942
 Data Preparation: 1.0s
 Epoch: 20 (36.7s)  LR: 0.00012 Train Loss: 3.52  Valid Loss: 4.69  Valid NDCG: 0.4855
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 21 (36.5s)  LR: 0.00006 Train Loss: 3.49  Valid Loss: 4.39  Valid NDCG: 0.5326
 Data Preparation: 1.0s
 Epoch: 22 (36.4s)  LR: 0.00002 Train Loss: 3.51  Valid Loss: 4.87  Valid NDCG: 0.4829
 Data Preparation: 1.0s
 Epoch: 23 (36.8s)  LR: 0.00000 Train Loss: 3.51  Valid Loss: 4.89  Valid NDCG: 0.4841
 Data Preparation: 1.0s
 Epoch: 24 (36.3s)  LR: 0.00000 Train Loss: 3.51  Valid Loss: 4.96  Valid NDCG: 0.4976
 Data Preparation: 1.0s
 Epoch: 25 (36.5s)  LR: 0.00003 Train Loss: 3.49  Valid Loss: 4.63  Valid NDCG: 0.5134
 Data Preparation: 1.0s
 Epoch: 26 (36.5s)  LR: 0.00007 Train Loss: 3.44  Valid Loss: 4.57  Valid NDCG: 0.5164
 Data Preparation: 1.1s
 Epoch: 27 (36.5s)  LR: 0.00012 Train Loss: 3.42  Valid Loss: 4.73  Valid NDCG: 0.4959
 Data Preparation: 1.1s
 Epoch: 28 (36.6s)  LR: 0.00020 Train Loss: 3.40  Valid Loss: 4.91  Valid NDCG: 0.4830
 Data Preparation: 1.0s
 Epoch: 29 (36.3s)  LR: 0.00028 Train Loss: 3.35  Valid Loss: 4.91  Valid NDCG: 0.4883
 Data Preparation: 1.0s
 Epoch: 30 (36.8s)  LR: 0.00038 Train Loss: 3.31  Valid Loss: 4.88  Valid NDCG: 0.4914
 {'paper_author_write_first': 31495, 'paper_field_L1': 101272, 'paper_field_L2': 201175, 'paper_field_L0': 33064, 'paper_field_L3': 73602, 'paper_venue_Journal': 19564, 'rev_paper_paper': 12975, 'paper_field_L4': 25110, 'paper_author_write_last': 27326, 'paper_field_L5': 15092, 'paper_venue_Conference': 29296, 'paper_author_write_other': 41619, 'paper_paper': 12845, 'paper_venue_Repository': 1134, 'paper_venue_Patent': 5, 'rev_paper_author_write_other': 41619, 'author_affiliation': 80467, 'rev_paper_author_write_last': 27326, 'rev_paper_author_write_first': 31495, 'rev_paper_venue_Conference': 29296, 'rev_paper_venue_Journal': 19564, 'rev_paper_venue_Patent': 5, 'rev_paper_venue_Repository': 1134, 'field_field': 139035, 'rev_paper_field_L3': 73602, 'rev_field_field': 139035, 'rev_paper_field_L5': 15092, 'rev_paper_field_L2': 201175, 'rev_paper_field_L4': 25110, 'rev_paper_field_L1': 101272, 'rev_paper_field_L0': 33064, 'rev_author_affiliation': 80467}
 Last Test NDCG: 0.4667
 Last Test MRR:  0.6389
 Best Test NDCG: 0.4686
 Best Test MRR:  0.6494
 Done after 1342.0s