
 Namespace(batch_size=256, clip=0.25, conv_name='hgt', data_percentage=1.0, dropout=0.2, edge_name='paper_field_L2', exract_attention=False, fake_edges_percentage=0.7, graph_dir='output/graphs/OAG_graph50000.pk', graph_params_dir='config/HGT_graph_params_OAG.json', include_fake_edges=True, main_node='paper', model_dir='output', multi_lable_task=True, n_batch=32, n_epoch=30, n_heads=8, n_hid=400, n_layers=4, n_pool=4, optimizer='adamw', predicted_node_name='field', repeat=2, sample_depth=6, sample_width=128, show_tensor_board=False)
 Counter({'paper_field_L2': 201175, 'rev_paper_field_L2': 201175, 'field_field': 139035, 'rev_field_field': 139035, 'paper_field_L1': 107099, 'rev_paper_field_L1': 107099, 'author_affiliation': 80467, 'rev_author_affiliation': 80467, 'paper_field_L3': 73602, 'rev_paper_field_L3': 73602, 'paper_field_L0': 50036, 'rev_paper_field_L0': 50036, 'paper_author_write_other': 43403, 'rev_paper_author_write_other': 43403, 'paper_author_write_first': 33370, 'rev_paper_author_write_first': 33370, 'paper_venue_Conference': 29296, 'rev_paper_venue_Conference': 29296, 'paper_author_write_last': 28867, 'rev_paper_author_write_last': 28867, 'paper_field_L4': 25110, 'rev_paper_field_L4': 25110, 'paper_venue_Journal': 19564, 'rev_paper_venue_Journal': 19564, 'paper_field_L5': 15092, 'rev_paper_field_L5': 15092, 'rev_paper_paper': 12975, 'paper_paper': 12845, 'paper_venue_Repository': 1134, 'rev_paper_venue_Repository': 1134, 'paper_venue_Patent': 5, 'rev_paper_venue_Patent': 5})
 GNN configuration: 
 in_dim = 1169, n_hid = 400,              num_types = 5, num_relations = 35,             n_heads = 8, n_layers = 4, dropout = 0.2
 Data Preparation: 18.0s
 UPDATE!!!
 Epoch: 1 (42.7s)  LR: 0.00060 Train Loss: 6.60  Valid Loss: 6.36  Valid NDCG: 0.2135
 Data Preparation: 1.0s
 Epoch: 2 (37.4s)  LR: 0.00070 Train Loss: 6.03  Valid Loss: 6.42  Valid NDCG: 0.2100
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 3 (38.2s)  LR: 0.00078 Train Loss: 5.69  Valid Loss: 6.41  Valid NDCG: 0.2164
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 4 (37.1s)  LR: 0.00086 Train Loss: 5.33  Valid Loss: 6.33  Valid NDCG: 0.2457
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 5 (37.2s)  LR: 0.00092 Train Loss: 5.01  Valid Loss: 5.60  Valid NDCG: 0.3236
 Data Preparation: 0.9s
 UPDATE!!!
 Epoch: 6 (37.3s)  LR: 0.00097 Train Loss: 4.77  Valid Loss: 5.75  Valid NDCG: 0.3484
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 7 (37.5s)  LR: 0.00099 Train Loss: 4.56  Valid Loss: 5.62  Valid NDCG: 0.3728
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 8 (37.8s)  LR: 0.00100 Train Loss: 4.40  Valid Loss: 5.52  Valid NDCG: 0.3775
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 9 (37.3s)  LR: 0.00099 Train Loss: 4.19  Valid Loss: 5.35  Valid NDCG: 0.4059
 Data Preparation: 0.9s
 Epoch: 10 (84.1s)  LR: 0.00095 Train Loss: 4.05  Valid Loss: 5.57  Valid NDCG: 0.3615
 37435/187175 will be taken
 5199/25993 will be taken
 42634 new edges will be added between Fields-author and venue-author get 0.2 from least attentions edges
 Data Preparation: 2.7s
 UPDATE!!!
 Epoch: 11 (37.5s)  LR: 0.00090 Train Loss: 3.95  Valid Loss: 5.16  Valid NDCG: 0.4373
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 12 (43.7s)  LR: 0.00083 Train Loss: 3.91  Valid Loss: 4.92  Valid NDCG: 0.4577
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 13 (43.8s)  LR: 0.00075 Train Loss: 3.70  Valid Loss: 4.96  Valid NDCG: 0.4669
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 14 (43.2s)  LR: 0.00066 Train Loss: 3.64  Valid Loss: 5.11  Valid NDCG: 0.4899
 Data Preparation: 1.0s
 Epoch: 15 (43.7s)  LR: 0.00056 Train Loss: 3.50  Valid Loss: 5.13  Valid NDCG: 0.4636
 Data Preparation: 1.0s
 Epoch: 16 (43.6s)  LR: 0.00046 Train Loss: 3.47  Valid Loss: 5.00  Valid NDCG: 0.4732
 Data Preparation: 1.0s
 Epoch: 17 (44.5s)  LR: 0.00036 Train Loss: 3.39  Valid Loss: 5.31  Valid NDCG: 0.4420
 Data Preparation: 1.0s
 Epoch: 18 (43.2s)  LR: 0.00027 Train Loss: 3.36  Valid Loss: 4.98  Valid NDCG: 0.4802
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 19 (43.3s)  LR: 0.00019 Train Loss: 3.31  Valid Loss: 4.64  Valid NDCG: 0.5108
 Data Preparation: 1.0s
 Epoch: 20 (43.2s)  LR: 0.00012 Train Loss: 3.25  Valid Loss: 4.83  Valid NDCG: 0.4804
 Data Preparation: 1.0s
 UPDATE!!!
 Epoch: 21 (43.4s)  LR: 0.00006 Train Loss: 3.25  Valid Loss: 4.40  Valid NDCG: 0.5380
 Data Preparation: 1.0s
 Epoch: 22 (43.2s)  LR: 0.00002 Train Loss: 3.29  Valid Loss: 4.87  Valid NDCG: 0.5024
 Data Preparation: 1.0s
 Epoch: 23 (45.1s)  LR: 0.00000 Train Loss: 3.28  Valid Loss: 4.88  Valid NDCG: 0.5011
 Data Preparation: 1.0s
 Epoch: 24 (45.7s)  LR: 0.00000 Train Loss: 3.31  Valid Loss: 5.05  Valid NDCG: 0.4958
 Data Preparation: 1.0s
 Epoch: 25 (45.7s)  LR: 0.00003 Train Loss: 3.27  Valid Loss: 4.75  Valid NDCG: 0.5154
 Data Preparation: 1.0s
 Epoch: 26 (45.4s)  LR: 0.00007 Train Loss: 3.24  Valid Loss: 4.66  Valid NDCG: 0.5220
 Data Preparation: 1.1s
 Epoch: 27 (44.7s)  LR: 0.00012 Train Loss: 3.21  Valid Loss: 4.64  Valid NDCG: 0.5247
 Data Preparation: 1.0s
 Epoch: 28 (45.0s)  LR: 0.00020 Train Loss: 3.16  Valid Loss: 4.83  Valid NDCG: 0.4914
 Data Preparation: 0.9s
 Epoch: 29 (44.0s)  LR: 0.00028 Train Loss: 3.11  Valid Loss: 4.97  Valid NDCG: 0.4993
 Data Preparation: 0.9s
 Epoch: 30 (45.4s)  LR: 0.00038 Train Loss: 3.05  Valid Loss: 4.93  Valid NDCG: 0.5011
 {'paper_author_write_first': 33370, 'paper_field_L1': 107099, 'paper_field_L2': 201175, 'paper_field_L0': 50036, 'paper_field_L3': 73602, 'paper_venue_Journal': 19564, 'rev_paper_paper': 12975, 'paper_field_L4': 25110, 'paper_author_write_last': 28867, 'paper_field_L5': 15092, 'paper_venue_Conference': 29296, 'paper_author_write_other': 43403, 'paper_paper': 12845, 'paper_venue_Repository': 1134, 'paper_venue_Patent': 5, 'rev_paper_author_write_other': 43403, 'author_affiliation': 80467, 'rev_paper_author_write_last': 28867, 'rev_paper_author_write_first': 33370, 'rev_fake_edge': 19925, 'rev_paper_venue_Conference': 29296, 'rev_paper_venue_Journal': 19564, 'fake_edge': 19925, 'rev_paper_venue_Patent': 5, 'rev_paper_venue_Repository': 1134, 'field_field': 139035, 'rev_paper_field_L3': 73602, 'rev_field_field': 139035, 'rev_paper_field_L5': 15092, 'rev_paper_field_L2': 201175, 'rev_paper_field_L4': 25110, 'rev_paper_field_L1': 107099, 'rev_paper_field_L0': 50036, 'rev_author_affiliation': 80467}
 Last Test NDCG: 0.4844
 Last Test MRR:  0.6687
 Best Test NDCG: 0.4717
 Best Test MRR:  0.6600
 Done after 1434.8s